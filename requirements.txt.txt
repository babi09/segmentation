import os
import pandas as pd
import streamlit as st
import matplotlib.pyplot as plt
from matplotlib import transforms
import numpy as np
import SimpleITK as sitk
import nibabel as nib
import modelDeployment
import funcs_ha_use
from __future__ import print_function
from __future__ import absolute_import
from __future__ import division

import warnings

from keras.models import Model, load_model
from keras.layers.core import Dense, Dropout, Activation, Reshape
from keras.layers.convolutional import Conv3D, Conv3DTranspose, UpSampling3D
from keras.layers.pooling import AveragePooling3D, MaxPooling3D
from keras.layers.pooling import GlobalAveragePooling3D
from keras.layers import Input
from keras.layers.merge import concatenate
from keras.layers.normalization import BatchNormalization
from keras.regularizers import l2
from keras.utils.layer_utils import convert_all_kernels_in_model, convert_dense_weights_data_format
from keras.utils.data_utils import get_file
from keras.engine.topology import get_source_inputs
import keras.backend as K
from scipy.ndimage import zoom
import detectCroppedSeg3DKerasDR_predict_ha
import pickle, random
from skimage.transform import warp, AffineTransform
from scipy.ndimage import zoom
from keras import losses
from keras.models import Model, load_model
from keras.layers import Dropout, Input, concatenate, Conv3D, MaxPooling3D, UpSampling3D, BatchNormalization, add
from keras.layers import Reshape, Conv2D, MaxPooling2D, TimeDistributed, Conv2DTranspose
from keras.models import Sequential
from keras.optimizers import Adam, SGD
from keras.layers import Activation, Dense, ZeroPadding3D